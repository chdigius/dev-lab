(function(){"use strict";var e={9729:function(e,n,r){var o=r(5130),t=r(6768);function a(e,n){const r=(0,t.g2)("router-view");return(0,t.uX)(),(0,t.Wv)(r)}var s=r(1241);const l={},u=(0,s.A)(l,[["render",a]]);var i=u,c=r(1387);const d={class:"welcome container"},p=(0,t.Lk)("p",null,"Welcome",-1),m={key:0},v=(0,t.Lk)("h2",null,"Login",-1),g={key:1},h=(0,t.Lk)("h2",null,"Sign up",-1);function f(e,n,r,o,a,s){const l=(0,t.g2)("LoginForm"),u=(0,t.g2)("SignupForm");return(0,t.uX)(),(0,t.CE)("div",d,[p,o.showLogin?((0,t.uX)(),(0,t.CE)("div",m,[v,(0,t.bF)(l,{onLogin:o.enterChat},null,8,["onLogin"]),(0,t.Lk)("p",null,[(0,t.eW)("No account yet? "),(0,t.Lk)("span",{onClick:n[0]||(n[0]=e=>o.showLogin=!1)},"Sign up"),(0,t.eW)(" instead")])])):((0,t.uX)(),(0,t.CE)("div",g,[h,(0,t.bF)(u,{onSignup:o.enterChat},null,8,["onSignup"]),(0,t.Lk)("p",null,[(0,t.eW)("Already registered? "),(0,t.Lk)("span",{onClick:n[1]||(n[1]=e=>o.showLogin=!0)},"Login"),(0,t.eW)(" instead")])]))])}r(4114);var w=r(4232);const y={class:"error"},b=(0,t.Lk)("button",null,"Sign Up",-1);function k(e,n,r,a,s,l){return(0,t.uX)(),(0,t.CE)("form",{onSubmit:n[3]||(n[3]=(0,o.D$)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]))},[(0,t.bo)((0,t.Lk)("input",{type:"text",required:"",placeholder:"display name","onUpdate:modelValue":n[0]||(n[0]=e=>a.displayName=e)},null,512),[[o.Jo,a.displayName]]),(0,t.bo)((0,t.Lk)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[1]||(n[1]=e=>a.email=e)},null,512),[[o.Jo,a.email]]),(0,t.bo)((0,t.Lk)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[2]||(n[2]=e=>a.password=e)},null,512),[[o.Jo,a.password]]),(0,t.Lk)("div",y,(0,w.v_)(a.error),1),b],32)}var L=r(144),C=r(2829);r(289),r(8307);const A={apiKey:"AIzaSyAgOxws0swd8KJftDZgEXSWbz1dmyx99O8",authDomain:"vue-demo-sites.firebaseapp.com",projectId:"vue-demo-sites",storageBucket:"vue-demo-sites.appspot.com",messagingSenderId:"1094108994745",appId:"1:1094108994745:web:5bd11dfa4f532d4883cf68",measurementId:"G-BXFBEBPVEB"};C.A.initializeApp(A);const E=C.A.auth(),S=C.A.firestore(),K=C.A.firestore.FieldValue.serverTimestamp,_=(0,L.KR)(null),R=async(e,n,r)=>{_.value=null;try{const o=await E.createUserWithEmailAndPassword(e,n);if(!o)throw new Error("Could not complete the sign up");return await o.user.updateProfile({displayName:r}),_.value=null,console.log(o.user),o}catch(o){console.log(o.message),_.value=o.message}},X=()=>({error:_,signup:R});var F=X,W={setup(e,n){const{error:r,signup:o}=F(),t=(0,L.KR)(""),a=(0,L.KR)(""),s=(0,L.KR)(""),l=async()=>{await o(a.value,s.value,t.value),r.value||(console.log("user logged in"),n.emit("signup"))};return{displayName:t,email:a,password:s,handleSubmit:l,error:r}}};const O=(0,s.A)(W,[["render",k]]);var U=O;const I={class:"error"},N=(0,t.Lk)("button",null,"Login",-1);function D(e,n,r,a,s,l){return(0,t.uX)(),(0,t.CE)("form",{onSubmit:n[2]||(n[2]=(0,o.D$)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]))},[(0,t.bo)((0,t.Lk)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[0]||(n[0]=e=>a.email=e)},null,512),[[o.Jo,a.email]]),(0,t.bo)((0,t.Lk)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[1]||(n[1]=e=>a.password=e)},null,512),[[o.Jo,a.password]]),(0,t.Lk)("div",I,(0,w.v_)(a.error),1),N],32)}const x=(0,L.KR)(null),j=async(e,n)=>{x.value=null;try{const r=await E.signInWithEmailAndPassword(e,n);if(!r)throw new Error("Incorrect login credentials");return x.value=null,console.log(r),r}catch(r){console.log(x.message),x.value="Incorrect Login Credentials."}},V=()=>({error:x,login:j});var B=V,J={setup(e,n){const{error:r,login:o}=B(),t=(0,L.KR)(""),a=(0,L.KR)(""),s=async()=>{await o(t.value,a.value),r.value||(console.log("user logged in"),n.emit("login"))};return{email:t,password:a,handleSubmit:s,error:r}}};const P=(0,s.A)(J,[["render",D]]);var T=P,q={components:{SignupForm:U,LoginForm:T},setup(){const e=(0,L.KR)(!0),n=(0,c.rd)(),r=()=>{n.push({name:"Chatroom"})};return{showLogin:e,enterChat:r}}};const $=(0,s.A)(q,[["render",f]]);var z=$;const Q={class:"container"};function H(e,n,r,o,a,s){const l=(0,t.g2)("Navbar"),u=(0,t.g2)("ChatWindow"),i=(0,t.g2)("NewChatForm");return(0,t.uX)(),(0,t.CE)("div",Q,[(0,t.bF)(l),(0,t.bF)(u),(0,t.bF)(i)])}const G={class:"error"};function M(e,n,r,a,s,l){return(0,t.uX)(),(0,t.CE)("form",null,[(0,t.bo)((0,t.Lk)("textarea",{placeholder:"Type a message and hit enter to send...","onUpdate:modelValue":n[0]||(n[0]=e=>a.message=e),onKeypress:n[1]||(n[1]=(0,o.jR)((0,o.D$)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]),["enter"]))},null,544),[[o.Jo,a.message]]),(0,t.Lk)("div",G,(0,w.v_)(a.error),1)])}const Z=(0,L.KR)(E.currentUser);E.onAuthStateChanged((e=>{console.log("User state change.  Current user is: ",e),Z.value=e}));const Y=()=>({user:Z});var ee=Y;const ne=e=>{const n=(0,L.KR)(null),r=async r=>{n.value=null;try{await S.collection(e).add(r)}catch(o){console.log(o.message),n.value="could not send the message..."}};return{error:n,addDoc:r}};var re=ne,oe={setup(){const{user:e}=ee(),{addDoc:n,error:r}=re("messages-live-chat"),o=(0,L.KR)(""),t=async()=>{const t={name:e.value.displayName,message:o.value,createdAt:K()};await n(t),r.value||(o.value="")};return{message:o,handleSubmit:t,error:r}}};const te=(0,s.A)(oe,[["render",M],["__scopeId","data-v-544ad08e"]]);var ae=te;const se={class:"chat-window"},le={key:0},ue={key:1,class:"messages",ref:"messages"},ie={class:"created-at"},ce={class:"name"},de={class:"message"};function pe(e,n,r,o,a,s){return(0,t.uX)(),(0,t.CE)("div",se,[o.error?((0,t.uX)(),(0,t.CE)("div",le,(0,w.v_)(o.error),1)):(0,t.Q3)("",!0),o.documents?((0,t.uX)(),(0,t.CE)("div",ue,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(o.formattedDocuments,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"single"},[(0,t.Lk)("span",ie,(0,w.v_)(e.createdAt),1),(0,t.Lk)("span",ce,(0,w.v_)(e.name)+":",1),(0,t.Lk)("span",de,(0,w.v_)(e.message),1)])))),128))],512)):(0,t.Q3)("",!0)])}const me=e=>{const n=(0,L.KR)(null),r=(0,L.KR)(null);let o=S.collection(e).orderBy("createdAt");const a=o.onSnapshot((e=>{let o=[];e.docs.forEach((e=>{e.data().createdAt&&o.push({...e.data(),id:e.id})})),n.value=o,r.value=null}),(e=>{console.log(e.message),n.value=null,r.value="could not fetch data"}));return(0,t.nT)((e=>{e((()=>a()))})),{documents:n,error:r}};var ve=me,ge=r(11),he={setup(){const{error:e,documents:n}=ve("messages-live-chat"),r=(0,t.EW)((()=>{if(n.value)return n.value.map((e=>{let n=(0,ge.m)(e.createdAt.toDate());return{...e,createdAt:n}}))})),o=(0,L.KR)(null);return(0,t.$u)((()=>{o.value.scrollTop=o.value.scrollHeight})),{error:e,documents:n,formattedDocuments:r,messages:o}}};const fe=(0,s.A)(he,[["render",pe],["__scopeId","data-v-8e521fca"]]);var we=fe;const ye={key:0},be={class:"email"};function ke(e,n,r,o,a,s){return o.user?((0,t.uX)(),(0,t.CE)("nav",ye,[(0,t.Lk)("div",null,[(0,t.Lk)("p",null,"Hey there "+(0,w.v_)(o.user.displayName),1),(0,t.Lk)("p",be,"Currently logged in as "+(0,w.v_)(o.user.email),1)]),(0,t.Lk)("button",{onClick:n[0]||(n[0]=(...e)=>o.handleClick&&o.handleClick(...e))},"Logout")])):(0,t.Q3)("",!0)}const Le=(0,L.KR)(null),Ce=async()=>{Le.value=null;try{await E.signOut()}catch(e){console.log(e.message),Le.value=e.message}},Ae=()=>({logout:Ce,error:Le});var Ee=Ae,Se={setup(){const{logout:e,error:n}=Ee(),{user:r}=ee(),o=async()=>{await e(),n.value||console.log("user logged out")};return{handleClick:o,user:r}}};const Ke=(0,s.A)(Se,[["render",ke]]);var _e=Ke,Re={components:{Navbar:_e,NewChatForm:ae,ChatWindow:we},setup(){const{user:e}=ee(),n=(0,c.rd)();(0,t.wB)(e,(()=>{e.value||n.push({name:"Welcome"})}))}};const Xe=(0,s.A)(Re,[["render",H]]);var Fe=Xe;const We=(e,n,r)=>{let o=E.currentUser;console.log("current user in auth guard: ",o),o?r():r({name:"Welcome"})},Oe=(e,n,r)=>{let o=E.currentUser;console.log("current user in auth guard: ",o),o?r({name:"Chatroom"}):r()},Ue=[{path:"/",name:"Welcome",component:z,beforeEnter:Oe},{path:"/chatroom",name:"Chatroom",component:Fe,beforeEnter:We}],Ie=(0,c.aE)({history:(0,c.LA)("/"),routes:Ue});var Ne=Ie;let De;E.onAuthStateChanged((()=>{De||(De=(0,o.Ef)(i).use(Ne).mount("#app"))}))}},n={};function r(o){var t=n[o];if(void 0!==t)return t.exports;var a=n[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.m=e,function(){var e=[];r.O=function(n,o,t,a){if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],t=e[c][1],a=e[c][2];for(var l=!0,u=0;u<o.length;u++)(!1&a||s>=a)&&Object.keys(r.O).every((function(e){return r.O[e](o[u])}))?o.splice(u--,1):(l=!1,a<s&&(s=a));if(l){e.splice(c--,1);var i=t();void 0!==i&&(n=i)}}return n}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,t,a]}}(),function(){r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,{a:n}),n}}(),function(){r.d=function(e,n){for(var o in n)r.o(n,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={524:0};r.O.j=function(n){return 0===e[n]};var n=function(n,o){var t,a,s=o[0],l=o[1],u=o[2],i=0;if(s.some((function(n){return 0!==e[n]}))){for(t in l)r.o(l,t)&&(r.m[t]=l[t]);if(u)var c=u(r)}for(n&&n(o);i<s.length;i++)a=s[i],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},o=self["webpackChunklive_chat"]=self["webpackChunklive_chat"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(9729)}));o=r.O(o)})();
//# sourceMappingURL=app.9ad8c915.js.map